---
- hosts: localhost
  connection: local
  remote_user: root

  vars:
    ansible_python_interpreter: python

  vars_files:
    - do_codes.yml

  tasks:
    - setup:
      register: d_setup
      tags: setup
    - debug: var=d_setup
      tags: setup

    - name: create digital ocean droplet
      digital_ocean: >
          state=present
          command=droplet
          name=ofn-deployment-test-droplet
          client_id={{ ansible_env.DO_CLIENT_ID }}
          api_key={{ ansible_env.DO_API_KEY }}
          size_id={{ do_sizes_512mb }}
          region_id={{ do_regions_lon1 }}
          image_id=6918990
          wait_timeout=500
      register: ofn_test_droplet
    - debug: msg="ID is {{ ofn_test_droplet.droplet.id }}"
    - debug: msg="IP is {{ ofn_test_droplet.droplet.ip_address }}"


